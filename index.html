<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CÃ¢y ThÃ´ng Äiá»‡p</title>
  <link rel="preload" as="image" href="tree.jpg">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="layout">
    <!-- Panel trÃ¡i -->
    <section class="panel left-panel">
      <div class="panel-header">
        <h1>ğŸŒ± CÃ¢y ThÃ´ng Äiá»‡p</h1>
        <div class="header-buttons">
          <button class="theme-toggle" id="themeToggle" title="Chuyá»ƒn Ä‘á»•i cháº¿ Ä‘á»™ sÃ¡ng/tá»‘i">
            <span class="theme-icon">ğŸŒ™</span>
          </button>
        </div>
      </div>
      
      <p class="panel-description">Click vÃ o cÃ¢y Ä‘á»ƒ Ä‘áº·t lÃ¡ táº¡i vá»‹ trÃ­ báº¥t ká»³, hoáº·c tá»± Ä‘á»™ng thÃªm lÃ¡ ngáº«u nhiÃªn!</p>
      
      <div class="stats-section">
        <div class="stat-card">
          <div class="stat-icon">ğŸŒ¿</div>
          <div class="stat-content">
            <div class="stat-number" id="counter">0</div>
            <div class="stat-label">Sá»‘ lÃ¡ trÃªn cÃ¢y</div>
          </div>
        </div>
      </div>
      
      <div class="controls">
        <div class="view-mode-section">
          <label class="switch-container">
            <input type="checkbox" id="viewOnlyMode">
            <span class="switch-slider"></span>
            <span class="switch-label">Cháº¿ Ä‘á»™ chá»‰ xem</span>
          </label>
        </div>
        
        <div class="action-buttons" id="actionButtons">
          <button class="btn primary" id="add">
            <span class="btn-icon">ğŸ²</span>
            <span class="btn-text">Tá»± Ä‘á»™ng thÃªm</span>
          </button>
          <button class="btn secondary" id="toggleMode">
            <span class="btn-icon">ğŸ–±ï¸</span>
            <span class="btn-text">Click Ä‘á»ƒ Ä‘áº·t</span>
          </button>
          <button class="btn tertiary" id="dragMode">
            <span class="btn-icon">âœ‹</span>
            <span class="btn-text">KÃ©o tháº£</span>
          </button>
        </div>
      </div>
      
      <div class="additional-info">
        <div class="info-card">
          <div class="info-icon">ğŸ’Œ</div>
          <div class="info-content">
            <h3>Gá»­i thÃ´ng Ä‘iá»‡p yÃªu thÆ°Æ¡ng</h3>
            <p>TrÆ°á»›c khi viáº¿t lÃªn cÃ¢y tinh tháº§n, chÃºng mÃ¬nh mong báº¡n luÃ´n nhá»› ráº±ng: Ä‘Ã¢y lÃ  cÃ¢y cá»§a nhá»¯ng lá»i Ä‘á»™ng viÃªn, yÃªu thÆ°Æ¡ng vÃ  niá»m tin. Má»—i lá»i báº¡n Ä‘á»ƒ láº¡i sáº½ trá»Ÿ thÃ nh Ã¡nh sÃ¡ng nhá» sÆ°á»Ÿi áº¥m trÃ¡i tim má»™t ai Ä‘Ã³. HÃ£y chá»n mÃ u sáº¯c riÃªng cho chiáº¿c lÃ¡ á»©ng vá»›i váº¥n Ä‘á» báº¡n muá»‘n gá»­i lá»i Ä‘á»™ng viÃªn nhÃ©:</p>
            <div style="margin-top: 12px; font-size: 0.9rem; line-height: 1.4;">
              ğŸ’¸ TÃ i chÃ­nh â†’ Xanh lÃ¡<br>
              ğŸ’• TÃ¬nh yÃªu â†’ Há»“ng<br>
              ğŸ“š Há»c táº­p â†’ VÃ ng<br>
              ğŸ’¼ CÃ´ng viá»‡c â†’ Xanh dÆ°Æ¡ng<br>
              ğŸ¤ Má»‘i quan há»‡ â†’ TÃ­m<br>
              ğŸŒˆ KhÃ¡c â†’ Xanh pastel
            </div>
          </div>
        </div>
        
        <button class="btn secondary" id="helpBtn" style="width: 100%; margin-top: 16px;">
          <span class="btn-icon">ğŸ“–</span>
          <span class="btn-text">HÆ°á»›ng dáº«n sá»­ dá»¥ng</span>
        </button>
        
        <button class="btn info" id="projectInfoBtn" style="width: 100%; margin-top: 12px;">
          <span class="btn-icon">ğŸŒ¿</span>
          <span class="btn-text">ThÃ´ng tin dá»± Ã¡n</span>
        </button>
      </div>
    </section>

    <!-- SÃ¢n kháº¥u pháº£i -->
    <section class="stage panel" id="stage">
      <svg id="treeSvg" viewBox="0 0 553 666" preserveAspectRatio="xMidYMid meet" aria-label="CÃ¢y thÃ´ng Ä‘iá»‡p">
        <image href="tree.jpg" x="0" y="0" width="553" height="666" alt="CÃ¢y thÃ´ng" />
        
        <!-- NhÃ¡nh vÃ´ hÃ¬nh Ä‘á»ƒ bÃ¡m lÃ¡ -->
        <g id="branches" stroke="#0f172a" stroke-width="3" fill="none" opacity="0">
          <path d="M278 420 C240 402 200 377 168 358 140 342 118 332 98 326" />
          <path d="M282 420 C320 398 356 376 392 358 424 342 450 328 468 320" />
          <path d="M282 362 C244 342 210 320 178 304" />
          <path d="M286 358 C324 340 358 324 392 308" />
          <path d="M286 308 C246 290 214 270 184 254" />
          <path d="M290 304 C328 288 360 272 394 256" />
          <path d="M292 260 C326 244 356 226 388 212" />
          <path d="M288 258 C252 240 220 226 190 212" />
          <path d="M294 212 C330 198 360 182 386 168" />
          <path d="M286 214 C254 200 224 186 198 174" />
          <path d="M294 172 C320 162 346 148 366 136" />
          <path d="M284 172 C256 162 230 150 208 140" />
        </g>
        
        <g id="leaves"></g>
      </svg>
      <div class="ground"></div>
      <div class="tooltip" id="tip"></div>
    </section>
  </div>

  <!-- Add/Edit Modal -->
  <div class="modal" id="addModal" role="dialog" aria-modal="true" aria-labelledby="addModalTitle">
    <div class="sheet">
      <button class="x" id="closeAddModal" aria-label="ÄÃ³ng modal">âœ•</button>
      <h3 id="addModalTitle">ğŸŒ¿ ThÃªm lÃ¡ má»›i</h3>
      <div style="margin:16px 0">
        <label style="display:block;margin-bottom:8px;font-weight:600">ThÃ´ng Ä‘iá»‡p:</label>
        <textarea id="addMessage" placeholder="Nháº­p thÃ´ng Ä‘iá»‡p..." style="width:100%;min-height:80px;resize:vertical;padding:12px;border-radius:8px;border:1px solid #e2e8f0"></textarea>
      </div>
      <div style="margin:16px 0">
        <label style="display:block;margin-bottom:8px;font-weight:600">TÃªn cá»§a báº¡n:</label>
        <input type="text" id="addAuthor" placeholder="Nháº­p tÃªn hoáº·c Ä‘á»ƒ trá»‘ng (áº©n danh)" style="width:100%;padding:12px;border-radius:8px;border:1px solid #e2e8f0">
      </div>
      <div style="margin:16px 0">
        <label style="display:flex;align-items:center;gap:8px;cursor:pointer">
          <input type="checkbox" id="isAnonymous" style="transform:scale(1.2)">
          <span>Gá»­i áº©n danh</span>
        </label>
      </div>
      
      <div class="picker" id="leafPicker" style="margin:16px 0">
        <div class="picker-row">
          <label style="font-weight:600">HÃ¬nh dÃ¡ng lÃ¡</label>
          <select id="leafShape">
            <option value="oval">ğŸƒ Oval</option>
            <option value="round">â­• TrÃ²n</option>
            <option value="oak">ğŸŒ³ Sá»“i</option>
            <option value="maple">ğŸ Phong</option>
            <option value="heart">ğŸ’š TrÃ¡i tim</option>
            <option value="willow">ğŸŒ¿ Liá»…u</option>
            <option value="birch">ğŸŒ² Báº¡ch dÆ°Æ¡ng</option>
            <option value="ginkgo">ğŸŸ¡ Báº¡ch quáº£</option>
            <option value="elm">ğŸŒ± Du</option>
            <option value="bamboo">ğŸ‹ Tre</option>
            <option value="fern">ğŸŒ¿ DÆ°Æ¡ng xá»‰</option>
            <option value="cherry">ğŸŒ¸ Anh Ä‘Ã o</option>
          </select>
        </div>

        <div class="picker-row">
          <label style="font-weight:600">Chá»§ Ä‘á» thÃ´ng Ä‘iá»‡p</label>
          <select id="leafPalette">
            <option value="0">ğŸ’° Tiá»n báº¡c â†’ Xanh pastel</option>
            <option value="1">ğŸ’• TÃ¬nh yÃªu â†’ Há»“ng pastel</option>
            <option value="2">ğŸ“š Há»c táº­p â†’ VÃ ng pastel</option>
            <option value="3">ğŸ’¼ CÃ´ng viá»‡c â†’ Xanh dÆ°Æ¡ng pastel</option>
            <option value="4">ğŸ‘¥ Má»‘i quan há»‡ â†’ TÃ­m pastel</option>
            <option value="5">ğŸŒŸ KhÃ¡c â†’ Xanh lÃ¡ pastel nháº¡t</option>
          </select>
        </div>

        <div class="picker-row">
          <label style="font-weight:600">KÃ­ch cá»¡</label>
          <input type="range" id="leafScale" min="0.8" max="1.4" step="0.05" value="1">
        </div>

        <div class="picker-row">
          <label style="font-weight:600">GÃ³c xoay</label>
          <input type="range" id="leafRotation" min="-25" max="25" step="1" value="0">
        </div>

        <div class="preview" id="leafPreview"></div>
      </div>
      
      <div style="display:flex;gap:12px;margin-top:20px">
        <button class="btn primary" id="saveLeaf" style="flex:1">ğŸ’¾ LÆ°u</button>
        <button class="btn secondary" id="cancelAdd" style="flex:1">âŒ Há»§y</button>
      </div>
    </div>
  </div>

  <!-- Help Modal -->
  <div class="modal" id="helpModal" role="dialog" aria-modal="true">
    <div class="sheet">
      <button class="x" id="closeHelpModal" aria-label="ÄÃ³ng hÆ°á»›ng dáº«n">âœ•</button>
      <h3>â“ HÆ°á»›ng dáº«n sá»­ dá»¥ng</h3>
      <div class="help-content">
        <div class="help-section">
          <h4>ğŸŒ¿ CÃ¡ch thÃªm lÃ¡:</h4>
          <ul>
            <li><strong>Tá»± Ä‘á»™ng thÃªm:</strong> Nháº¥n nÃºt "ğŸ² Tá»± Ä‘á»™ng thÃªm" Ä‘á»ƒ thÃªm lÃ¡ á»Ÿ vá»‹ trÃ­ ngáº«u nhiÃªn</li>
            <li><strong>Click Ä‘á»ƒ Ä‘áº·t:</strong> Báº­t cháº¿ Ä‘á»™ nÃ y vÃ  click vÃ o cÃ¢y Ä‘á»ƒ Ä‘áº·t lÃ¡ chÃ­nh xÃ¡c</li>
          </ul>
        </div>
        <div class="help-section">
          <h4>âœï¸ TÆ°Æ¡ng tÃ¡c vá»›i lÃ¡:</h4>
          <ul>
            <li><strong>Xem thÃ´ng Ä‘iá»‡p:</strong> Click vÃ o báº¥t ká»³ chiáº¿c lÃ¡ nÃ o Ä‘á»ƒ Ä‘á»c ná»™i dung</li>
            <li><strong>KÃ©o tháº£:</strong> Báº­t cháº¿ Ä‘á»™ kÃ©o tháº£ vÃ  giá»¯ lÃ¡ Ä‘á»ƒ di chuyá»ƒn vá»‹ trÃ­</li>
            <li><strong>Sá»­a ná»™i dung:</strong> Trong popup xem lÃ¡, báº¡n cÃ³ thá»ƒ chá»‰nh sá»­a thÃ´ng Ä‘iá»‡p</li>
          </ul>
        </div>
        <div class="help-section">
          <h4>ğŸ‘ï¸ Cháº¿ Ä‘á»™ chá»‰ xem:</h4>
          <p>Báº­t Ä‘á»ƒ khÃ³a táº¥t cáº£ chá»©c nÄƒng chá»‰nh sá»­a, chá»‰ cho phÃ©p xem thÃ´ng Ä‘iá»‡p.</p>
        </div>
        <div class="help-section">
          <h4>ğŸ¨ TÃ¹y chá»‰nh lÃ¡:</h4>
          <p>Khi thÃªm lÃ¡ má»›i, báº¡n cÃ³ thá»ƒ chá»n hÃ¬nh dÃ¡ng, mÃ u sáº¯c, kÃ­ch thÆ°á»›c vÃ  gÃ³c xoay.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Project Info Modal -->
  <div class="modal" id="projectInfoModal" role="dialog" aria-modal="true">
    <div class="sheet">
      <button class="x" id="closeProjectInfoModal" aria-label="ÄÃ³ng thÃ´ng tin dá»± Ã¡n">âœ•</button>
      <h3>ğŸŒ¿ CÃ¢y tinh tháº§n</h3>
      <div class="help-content">
        <p style="line-height: 1.6; margin-bottom: 16px;">
          Trong guá»“ng quay táº¥t báº­t cá»§a cuá»™c sá»‘ng, Ä‘Ã´i khi chÃºng ta quÃªn ráº±ng háº¡nh phÃºc cÃ³ thá»ƒ Ä‘áº¿n tá»« nhá»¯ng Ä‘iá»u giáº£n dá»‹ nháº¥t. Dá»± Ã¡n Peace by Piece ra Ä‘á»i Ä‘á»ƒ gá»­i gáº¯m nhá»¯ng lá»i yÃªu thÆ°Æ¡ng, Ä‘á»™ng viÃªn vÃ  hy vá»ng â€“ nhÆ° tá»«ng chiáº¿c lÃ¡ nhá» mang trong mÃ¬nh thÃ´ng Ä‘iá»‡p bÃ¬nh yÃªn.
        </p>
        <p style="line-height: 1.6;">
          HÃ£y Ä‘á»ƒ má»—i ná»¥ cÆ°á»i, má»—i lá»i chia sáº» trá»Ÿ thÃ nh má»™t máº£nh ghÃ©p gÃ³p pháº§n táº¡o nÃªn bá»©c tranh háº¡nh phÃºc trá»n váº¹n. ğŸ’Œ
        </p>
      </div>
    </div>
  </div>

  <!-- View Modal -->
  <div class="modal" id="modal" role="dialog" aria-modal="true">
    <div class="sheet">
      <button class="x" id="closeModal" aria-label="ÄÃ³ng modal">âœ•</button>
      <h3>ğŸ’Œ ThÃ´ng Ä‘iá»‡p</h3>
      <div class="leaf-card">
        <div class="leaf-text">
          <p id="modalText"></p>
          <p id="modalAuthor"></p>
        </div>
      </div>
      <div class="leaf-actions">
        <button id="editLeaf" class="btn green">âœï¸ Sá»­a</button>
        <button id="deleteLeaf" class="btn red" style="display: none;">ğŸ—‘ï¸ XÃ³a</button>
      </div>
    </div>
  </div>

  <script type="module" src="./firebase-init.mjs"></script>
  <script src="script.js" defer></script>
</body>
</html>