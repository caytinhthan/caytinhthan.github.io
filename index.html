<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CÃ¢y ThÃ´ng Äiá»‡p</title>
  <link rel="preload" as="image" href="tree.jpg">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="layout">
    <!-- Panel trÃ¡i -->
    <section class="panel left-panel">
      <div class="panel-header">
        <h1>ğŸŒ± CÃ¢y ThÃ´ng Äiá»‡p</h1>
        <button class="theme-toggle" id="themeToggle" title="Chuyá»ƒn Ä‘á»•i cháº¿ Ä‘á»™ sÃ¡ng/tá»‘i">
          <span class="theme-icon">ğŸŒ™</span>
        </button>
      </div>
      
      <p class="panel-description">Click vÃ o cÃ¢y Ä‘á»ƒ Ä‘áº·t lÃ¡ táº¡i vá»‹ trÃ­ báº¥t ká»³, hoáº·c tá»± Ä‘á»™ng thÃªm lÃ¡ ngáº«u nhiÃªn!</p>
      
      <div class="stats-section">
        <div class="stat-card">
          <div class="stat-icon">ğŸŒ¿</div>
          <div class="stat-content">
            <div class="stat-number" id="counter">0</div>
            <div class="stat-label">LÃ¡ trÃªn cÃ¢y</div>
          </div>
        </div>
      </div>
      
      <div class="controls">
        <button class="btn primary" id="add">
          <span class="btn-icon">ğŸ²</span>
          <span class="btn-text">Tá»± Ä‘á»™ng thÃªm</span>
        </button>
        <button class="btn secondary" id="toggleMode">
          <span class="btn-icon">ğŸ¯</span>
          <span class="btn-text">Click Ä‘á»ƒ Ä‘áº·t</span>
        </button>
      </div>
      
      <div class="list-section">
        <div class="list-header">
          <h3>ğŸ“ Danh sÃ¡ch lÃ¡</h3>
          <button class="clear-all-btn" id="clearAll" title="XÃ³a táº¥t cáº£ lÃ¡" style="display: none;">
            <span>ğŸ—‘ï¸</span>
          </button>
        </div>
        <div class="list" id="list">
          <div class="empty-state" id="emptyState">
            <div class="empty-icon">ğŸŒ±</div>
            <p>ChÆ°a cÃ³ lÃ¡ nÃ o trÃªn cÃ¢y</p>
            <small>HÃ£y thÃªm lÃ¡ Ä‘áº§u tiÃªn!</small>
          </div>
        </div>
      </div>
    </section>

    <!-- SÃ¢n kháº¥u pháº£i -->
    <section class="stage panel" id="stage">
      <svg id="treeSvg" viewBox="0 0 553 666" preserveAspectRatio="xMidYMid meet" aria-label="CÃ¢y thÃ´ng Ä‘iá»‡p">
        <image href="tree.jpg" x="0" y="0" width="553" height="666" alt="CÃ¢y thÃ´ng" />
        
        <!-- NhÃ¡nh vÃ´ hÃ¬nh Ä‘á»ƒ bÃ¡m lÃ¡ -->
        <g id="branches" stroke="#0f172a" stroke-width="3" fill="none" opacity="0">
          <path d="M278 420 C240 402 200 377 168 358 140 342 118 332 98 326" />
          <path d="M282 420 C320 398 356 376 392 358 424 342 450 328 468 320" />
          <path d="M282 362 C244 342 210 320 178 304" />
          <path d="M286 358 C324 340 358 324 392 308" />
          <path d="M286 308 C246 290 214 270 184 254" />
          <path d="M290 304 C328 288 360 272 394 256" />
          <path d="M292 260 C326 244 356 226 388 212" />
          <path d="M288 258 C252 240 220 226 190 212" />
          <path d="M294 212 C330 198 360 182 386 168" />
          <path d="M286 214 C254 200 224 186 198 174" />
          <path d="M294 172 C320 162 346 148 366 136" />
          <path d="M284 172 C256 162 230 150 208 140" />
        </g>
        
        <g id="leaves"></g>
      </svg>
      <div class="ground"></div>
      <div class="tooltip" id="tip"></div>
    </section>
  </div>

  <!-- Add/Edit Modal -->
  <div class="modal" id="addModal" role="dialog" aria-modal="true" aria-labelledby="addModalTitle">
    <div class="sheet">
      <button class="x" id="closeAddModal" aria-label="ÄÃ³ng modal">âœ•</button>
      <h3 id="addModalTitle">ğŸŒ¿ ThÃªm lÃ¡ má»›i</h3>
      <div style="margin:16px 0">
        <label style="display:block;margin-bottom:8px;font-weight:600">ThÃ´ng Ä‘iá»‡p:</label>
        <textarea id="addMessage" placeholder="Nháº­p thÃ´ng Ä‘iá»‡p..." style="width:100%;min-height:80px;resize:vertical;padding:12px;border-radius:8px;border:1px solid #e2e8f0"></textarea>
      </div>
      <div style="margin:16px 0">
        <label style="display:block;margin-bottom:8px;font-weight:600">TÃªn cá»§a báº¡n:</label>
        <input type="text" id="addAuthor" placeholder="Nháº­p tÃªn hoáº·c Ä‘á»ƒ trá»‘ng (áº©n danh)" style="width:100%;padding:12px;border-radius:8px;border:1px solid #e2e8f0">
      </div>
      <div style="margin:16px 0">
        <label style="display:flex;align-items:center;gap:8px;cursor:pointer">
          <input type="checkbox" id="isAnonymous" style="transform:scale(1.2)">
          <span>Gá»­i áº©n danh</span>
        </label>
      </div>
      
      <div class="picker" id="leafPicker" style="margin:16px 0">
        <div class="picker-row">
          <label style="font-weight:600">HÃ¬nh dÃ¡ng lÃ¡</label>
          <select id="leafShape">
            <option value="oval">ğŸƒ Oval</option>
            <option value="round">â­• TrÃ²n</option>
            <option value="oak">ğŸŒ³ Sá»“i</option>
            <option value="maple">ğŸ Phong</option>
            <option value="heart">ğŸ’š TrÃ¡i tim</option>
            <option value="willow">ğŸŒ¿ Liá»…u</option>
            <option value="birch">ğŸŒ² Báº¡ch dÆ°Æ¡ng</option>
            <option value="ginkgo">ğŸŸ¡ Báº¡ch quáº£</option>
            <option value="elm">ğŸŒ± Du</option>
            <option value="bamboo">ğŸ‹ Tre</option>
            <option value="fern">ğŸŒ¿ DÆ°Æ¡ng xá»‰</option>
            <option value="cherry">ğŸŒ¸ Anh Ä‘Ã o</option>
          </select>
        </div>

        <div class="picker-row">
          <label style="font-weight:600">Báº£ng mÃ u</label>
          <select id="leafPalette">
            <option value="0">ğŸŒ¸ Há»“ng pastel</option>
            <option value="1">ğŸ’™ Xanh dÆ°Æ¡ng pastel</option>
            <option value="2">ğŸ’š Xanh lÃ¡ pastel</option>
            <option value="3">ğŸ’› VÃ ng nháº¡t</option>
            <option value="4">ğŸ’œ TÃ­m nháº¡t</option>
            <option value="5">ğŸŒ¹ Há»“ng rose</option>
            <option value="6">ğŸŒ¿ Mint</option>
            <option value="7">ğŸ‘ Peach</option>
            <option value="8">ğŸ§¡ Cam san hÃ´</option>
            <option value="9">ğŸŒ± Xanh chanh</option>
            <option value="10">â˜ï¸ Xanh sky</option>
            <option value="11">ğŸŒº Há»“ng magenta</option>
            <option value="12">ğŸ”® TÃ­m lavender</option>
            <option value="13">ğŸŒ³ Xanh spring</option>
            <option value="14">ğŸŒ¼ VÃ ng cream</option>
            <option value="15">ğŸ¦‹ TÃ­m periwinkle</option>
          </select>
        </div>

        <div class="picker-row">
          <label style="font-weight:600">KÃ­ch cá»¡</label>
          <input type="range" id="leafScale" min="0.8" max="1.4" step="0.05" value="1">
        </div>

        <div class="picker-row">
          <label style="font-weight:600">GÃ³c xoay</label>
          <input type="range" id="leafRotation" min="-25" max="25" step="1" value="0">
        </div>

        <div class="preview" id="leafPreview"></div>
      </div>
      
      <div style="display:flex;gap:12px;margin-top:20px">
        <button class="btn primary" id="saveLeaf" style="flex:1">ğŸ’¾ LÆ°u</button>
        <button class="btn secondary" id="cancelAdd" style="flex:1">âŒ Há»§y</button>
      </div>
    </div>
  </div>

  <!-- View Modal -->
  <div class="modal" id="modal" role="dialog" aria-modal="true">
    <div class="sheet">
      <button class="x" id="closeModal" aria-label="ÄÃ³ng modal">âœ•</button>
      <h3>ğŸ’Œ ThÃ´ng Ä‘iá»‡p</h3>
      <div class="leaf-card">
        <div class="leaf-icon">ğŸŒ¿</div>
        <div class="leaf-text">
          <p id="modalText"></p>
          <p id="modalAuthor"></p>
        </div>
      </div>
      <div class="leaf-actions">
        <button id="editLeaf" class="btn green">âœï¸ Sá»­a</button>
        <button id="deleteLeaf" class="btn red">ğŸ—‘ï¸ XÃ³a</button>
      </div>
    </div>
  </div>

  <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
  import { getDatabase, ref, set, remove, onValue } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBfr8tUEMT0jZpBe6Pl5NIOZlni2MWrYsM",
    authDomain: "caytinhthan.firebaseapp.com",
    databaseURL: "https://caytinhthan-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "caytinhthan",
    storageBucket: "caytinhthan.firebasestorage.app",
    messagingSenderId: "381361662805",
    appId: "1:381361662805:web:07d1fe119151cb95f75ddc",
    measurementId: "G-BHMHT2QGXN"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // Expose ra global cho script.js dÃ¹ng
  window._firebase = { db, ref, set, remove, onValue };
</script>
<script src="script.js"></script>
</body>
</html>